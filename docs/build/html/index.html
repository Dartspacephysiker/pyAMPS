<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Welcome to pyAMPS’s documentation! &#8212; pyAMPS 0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="welcome-to-pyamps-s-documentation">
<h1>Welcome to pyAMPS&#8217;s documentation!<a class="headerlink" href="#welcome-to-pyamps-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<span class="target" id="module-pyAMPS"></span><dl class="class">
<dt id="pyAMPS.AMPS">
<em class="property">class </em><code class="descclassname">pyAMPS.</code><code class="descname">AMPS</code><span class="sig-paren">(</span><em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>F107</em>, <em>minlat=60</em>, <em>maxlat=89.99</em>, <em>height=110.0</em>, <em>dr=2</em>, <em>M0=4</em>, <em>resolution=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate and plot maps of the model Average Magnetic field and Polar current System (AMPS)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; solar wind velocity in km/s</li>
<li><strong>By</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; IMF GSM y component in nT</li>
<li><strong>Bz</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; IMF GSM z component in nT</li>
<li><strong>tilt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; dipole tilt angle in degrees</li>
<li><strong>F107</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; F10.7 index in s.f.u.</li>
<li><strong>minlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) &#8211; low latitude boundary of grids  (default 60)</li>
<li><strong>maxlat</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) &#8211; low latitude boundary of grids  (default 89.99)</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em>, </em><em>optional</em>) &#8211; altitude of the ionospheric currents (default 110 km)</li>
<li><strong>dr</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) &#8211; latitudinal spacing between equal area grid points (default 2 degrees)</li>
<li><strong>M0</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) &#8211; number of grid points in the most poleward circle of equal area grid points (default 4)</li>
<li><strong>resolution</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em>, </em><em>optional</em>) &#8211; resolution in both directions of the scalar field grids (default 100)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize by supplying a set of external conditions:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="n">solar_wind_velocity_in_km_per_s</span><span class="p">,</span>
<span class="go">             IMF_By_in_nT, IMF_Bz_in_nT,</span>
<span class="go">             dipole_tilt_in_deg,</span>
<span class="go">             F107_index)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># make summary plot:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">plot_currents</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># extract map of field-aligned currents in north and south:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Jun</span><span class="p">,</span> <span class="n">Jus</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_upward_current_function</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Jus.flatten() will be evaluated at the following coords:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">scalargrid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlt</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">scalargrid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># get map of total height-integrated horizontal currents:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">je_n</span><span class="p">,</span> <span class="n">je_s</span><span class="p">,</span> <span class="n">jn_n</span><span class="p">,</span> <span class="n">jn_s</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">get_total_current</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># je_n, the eastward current in northern hemisphere, will</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># be evaluated at the following coords:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vectorgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlt</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">vectorgrid</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># update model vectors (tor_c, tor_s, etc.) without</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># recalculating the other matrices:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">new_v</span><span class="p">,</span> <span class="n">new_By</span><span class="p">,</span> <span class="n">new_Bz</span><span class="p">,</span> <span class="n">new_tilt</span><span class="p">,</span> <span class="n">new_F107</span><span class="p">)</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="pyAMPS.AMPS.tor_c">
<code class="descname">tor_c</code><a class="headerlink" href="#pyAMPS.AMPS.tor_c" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em> &#8211; vector of cos term coefficents in the toroidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.tor_s">
<code class="descname">tor_s</code><a class="headerlink" href="#pyAMPS.AMPS.tor_s" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em> &#8211; vector of sin term coefficents in the toroidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.pol_c">
<code class="descname">pol_c</code><a class="headerlink" href="#pyAMPS.AMPS.pol_c" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em> &#8211; vector of cos term coefficents in the poloidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.pol_s">
<code class="descname">pol_s</code><a class="headerlink" href="#pyAMPS.AMPS.pol_s" title="Permalink to this definition">¶</a></dt>
<dd><p><em>np.array</em> &#8211; vector of sin term coefficents in the poloidal field expansion</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.keys_P">
<code class="descname">keys_P</code><a class="headerlink" href="#pyAMPS.AMPS.keys_P" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> &#8211; list of spherical harmonic wave number pairs (n,m) corresponding to elements of pol_c and pol_s</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.keys_T">
<code class="descname">keys_T</code><a class="headerlink" href="#pyAMPS.AMPS.keys_T" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list</em> &#8211; list of spherical harmonic wave number pairs (n,m) corresponding to elements of tor_c and tor_s</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.vectorgrid">
<code class="descname">vectorgrid</code><a class="headerlink" href="#pyAMPS.AMPS.vectorgrid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tuple</em> &#8211; grid used to calculate and plot vector fields</p>
</dd></dl>

<dl class="attribute">
<dt id="pyAMPS.AMPS.scalargrid">
<code class="descname">scalargrid</code><a class="headerlink" href="#pyAMPS.AMPS.scalargrid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tuple</em> &#8211; grid used to calculate and plot scalar fields</p>
<p>The grid formats are as follows (see also example below):
(np.hstack((mlat_north, mlat_south)), np.hstack((mlt_north, mlt_south)))</p>
<p>The grids can be changed directly, but member function calculate_matrices()
must then be called for the change to take effect. Also the grid format
described above should be used.</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.calculate_matrices">
<code class="descname">calculate_matrices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.calculate_matrices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.calculate_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the matrices that are needed to calculate currents and potentials</p>
<p>Call this function if and only if the grid has been changed manually</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_AE_indices">
<code class="descname">get_AE_indices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_AE_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_AE_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate model AE indices, AL and AU by calculating the (QD) northward component on a uniform grid, and
returning the minima (AL) and maxima (AU) in both hemispheres</p>
<p>return: AL_n, AL_s, AU_n, AU_s</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_curl_free_current">
<code class="descname">get_curl_free_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_curl_free_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_curl_free_current" title="Permalink to this definition">¶</a></dt>
<dd><p>get curl-free current vectors from toroidal scalar</p>
<p>unit is mA/m</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_curl_free_current_potential">
<code class="descname">get_curl_free_current_potential</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_curl_free_current_potential"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_curl_free_current_potential" title="Permalink to this definition">¶</a></dt>
<dd><p>get the curl-free current scalar potential from toroidal scalar</p>
<p>returns tuple with values for north and south</p>
<p>in kA</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_divergence_free_current">
<code class="descname">get_divergence_free_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_divergence_free_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_divergence_free_current" title="Permalink to this definition">¶</a></dt>
<dd><p>get divergence-free current vectors on vector grid</p>
<p>This is calculated as k cross grad(equivalent current function)</p>
<p>Return values are east_n, east_s, north_n, north_s, corresponding to the
east and north vector components in the northern and southern hemispheres</p>
<p>Calculated at REFRE + height</p>
<p>unit in mA/m</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_equivalent_current_function">
<code class="descname">get_equivalent_current_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_equivalent_current_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_equivalent_current_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the equivalent current function (unit is kA). Isocontours of the
equivalent current function indicates the alignment of the divergence-free
part of the horizontal current. Its direction is given by the cross product between
a vertical vector and the gradient of the equivalent current function.
A fixed amount of current flows between isocontours. The calculations refer to
the height chosen upon initialization of the AMPS object (default 110 km).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Normally, the term <cite>equivalent current</cite> signifies a horizontal current in space which is
equivalent with observed ground magnetic field perturbations. The present <cite>equivalent current</cite>
is derived from measurements above the ionosphere, and thus it contains signal both from
ionospheric currents below low Earth orbit, and from subsurface induced currents.
See Laundal et al. (2016) <a class="reference external" href="https://doi.org/10.1186/s40623-016-0518-x">https://doi.org/10.1186/s40623-016-0518-x</a> where this current is called
<cite>Psi</cite> for more detail.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>Psi_n</strong> (<em>numpy.array</em>) &#8211; Equivalent current function in the northern hemisphere.
Shape: (self.resolution, self.resolution)</li>
<li><strong>Psi_s</strong> (<em>numpy.array</em>) &#8211; Equivalent current function in the southern hemisphere.
Shape: (self.resolution, self.resolution)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_equivalent_current_laplacian">
<code class="descname">get_equivalent_current_laplacian</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_equivalent_current_laplacian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_equivalent_current_laplacian" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the Laplacian of the equivalent current function. In some circumstances, this
quantity is similar to the upward current.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>d2P_n</strong> (<em>numpy.array</em>) &#8211; Laplacian of the equivalent current function in the northern hemisphere.
Shape: (self.resolution, self.resolution)</li>
<li><strong>d2P_s</strong> (<em>numpy.array</em>) &#8211; Laplacian of the equivalent current function in the southern hemisphere.
Shape: (self.resolution, self.resolution)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_ground_perturbation">
<code class="descname">get_ground_perturbation</code><span class="sig-paren">(</span><em>mlat</em>, <em>mlt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_ground_perturbation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_ground_perturbation" title="Permalink to this definition">¶</a></dt>
<dd><p>return ground perturbation at mlat, mlt</p>
<p>return values are east, north, with same shape as mlat and mlt
The assumption is that the equivalent current function corresponds to an
external magnetic potential as in Chapman and Bartels (and Laundal et al. 2016)</p>
<p>(to calculate long time series of ground perturbations, there are faster ways than this function)</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_integrated_bc">
<code class="descname">get_integrated_bc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_integrated_bc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_integrated_bc" title="Permalink to this definition">¶</a></dt>
<dd><p>integrate birkeland current poleward of minlat
return (in MA), J_up_north, J_down_north, J_up_south, J_down_south</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_poloidal_scalar">
<code class="descname">get_poloidal_scalar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_poloidal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_poloidal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the poloidal scalar potential values (unit is microTm).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>V_n</strong> (<em>numpy.array</em>) &#8211; Poloidal scalar potential in the northern hemisphere.
Shape: (self.resolution, self.resolution)</li>
<li><strong>V_s</strong> (<em>numpy.array</em>) &#8211; Poloidal scalar potential in the southern hemisphere.
Shape: (self.resolution, self.resolution)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_toroidal_scalar">
<code class="descname">get_toroidal_scalar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_toroidal_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_toroidal_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the toroidal scalar values (unit is nT).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>T_n</strong> (<em>numpy.array</em>) &#8211; Toroidal scalar in the northern hemisphere.
Shape: (self.resolution, self.resolution)</li>
<li><strong>T_s</strong> (<em>numpy.array</em>) &#8211; Toroidal scalar in the southern hemisphere.
Shape: (self.resolution, self.resolution)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_total_current">
<code class="descname">get_total_current</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_total_current"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_total_current" title="Permalink to this definition">¶</a></dt>
<dd><p>get total current vectors by summing curl-free and divergence-free parts</p>
<p>return sum of curl free and divergence free currents</p>
<p>unit in mA/m</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.get_upward_current_function">
<code class="descname">get_upward_current_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.get_upward_current_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.get_upward_current_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Calcalculate upward current function from toroidal scalar, in uA/m^2</p>
<blockquote>
<div>returns tuple with values for north and south</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.plot_currents">
<code class="descname">plot_currents</code><span class="sig-paren">(</span><em>VECTOR_SCALE=200</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.plot_currents"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.plot_currents" title="Permalink to this definition">¶</a></dt>
<dd><p>plot all the current fields</p>
</dd></dl>

<dl class="method">
<dt id="pyAMPS.AMPS.update_model">
<code class="descname">update_model</code><span class="sig-paren">(</span><em>v</em>, <em>By</em>, <em>Bz</em>, <em>tilt</em>, <em>F107</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyAMPS/AMPS.html#AMPS.update_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyAMPS.AMPS.update_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model vectors without updating all the other matrices. This leads to better
performance than just making a new AMPS object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; solar wind velocity in km/s</li>
<li><strong>By</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; IMF GSM y component in nT</li>
<li><strong>Bz</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; IMF GSM z component in nT</li>
<li><strong>tilt</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; dipole tilt angle in degrees</li>
<li><strong>F107</strong> (<a class="reference external" href="https://docs.python.org/2/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) &#8211; F10.7 index in s.f.u.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>If model currents shall be calculated on the same grid for a range of
external conditions, it is faster to do this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="n">solar_wind_velocity_in_km_per_s</span><span class="p">,</span> <span class="n">IMF_By_in_nT</span><span class="p">,</span> <span class="n">IMF_Bz_in_nT</span><span class="p">,</span> <span class="n">dipole_tilt_in_deg</span><span class="p">,</span> <span class="n">F107_index</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... current calculations ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span><span class="o">.</span><span class="n">update_model</span><span class="p">(</span><span class="n">new_v</span><span class="p">,</span> <span class="n">new_By</span><span class="p">,</span> <span class="n">new_Bz</span><span class="p">,</span> <span class="n">new_tilt</span><span class="p">,</span> <span class="n">new_F107</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... new current calcuations ...</span>
</pre></div>
</div>
<p>than to make a new object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m2</span> <span class="o">=</span> <span class="n">AMPS</span><span class="p">(</span><span class="n">new_v</span><span class="p">,</span> <span class="n">new_By</span><span class="p">,</span> <span class="n">new_Bz</span><span class="p">,</span> <span class="n">new_tilt</span><span class="p">,</span> <span class="n">new_F107</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ... new current calculations ...</span>
</pre></div>
</div>
<p>Also note that the inputs are scalars in both cases. It is possible to optimize the calculations significantly
by allowing the inputs to be arrays. That is not yet implemented.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Welcome to pyAMPS&#8217;s documentation!</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Karl M. Laundal.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>